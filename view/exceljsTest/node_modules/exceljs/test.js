/**
 * Created by nhancao on 2/18/16.
 */
var start, finish;

//start = new Date();
var title = "Loop on numbers"
console.time(title);
var Excel = require("exceljs");
// read from a file
//var workbook = new Excel.Workbook();
//workbook.xlsx.readFile("./testcase/case1-25x25.xlsx")
//    .then(function () {
//        // use workbook
//    });
// This creates a file and is not needed.
// You will need to open a stream instead
// var workbook = new Excel.Workbook();
// workbook.xlsx.writeFile("test.xls");

// You can find an example of the code here:
// https://github.com/guyonroche/exceljs#writing-xlsx

var options = {
    filename: "./testcase/case1-25x25.xlsx",
    useStyles: true,
    useSharedStrings: true
};

var workbook = new Excel.stream.xlsx.WorkbookWriter(options);
var sheet = workbook.addWorksheet("My Sheet");
var worksheet = workbook.getWorksheet("My Sheet");

worksheet.columns = [
    {header: "Id", key: "id", width: 10},
    {header: "Name", key: "name", width: 32},
    {header: "D.O.B.", key: "DOB", width: 10}
];

worksheet.addRow({id: 1, name: "John Doe", dob: new Date(1970, 1, 1)});
worksheet.addRow({id: 2, name: "Jane Doe", dob: new Date(1965, 1, 7)});
worksheet.commit(); // Need to commit the changes to the worksheet

workbook.commit(); // Finish the workbook

console.timeEnd(title);
